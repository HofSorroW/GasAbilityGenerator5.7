# v4.7 Generation Report System Reference

## Overview

v4.7 adds a machine-readable generation report system for CI/CD integration and debugging. Reports are saved as both UDataAsset (for in-editor inspection) and JSON (for external tooling).

## Key Files

| File | Purpose |
|------|---------|
| `GasAbilityGeneratorReport.h` | Report structs and helper class |
| `GasAbilityGeneratorReport.cpp` | Report implementation |
| `GasAbilityGeneratorCommandlet.cpp` | Report creation hooks |
| `GasAbilityGeneratorTypes.h` | FGenerationResult with AssetPath/GeneratorId |

## Report Structure

### FGenerationReportItem

Each generated asset produces one report item:

```cpp
struct FGenerationReportItem
{
    FString AssetPath;          // "/Game/FatherCompanion/Abilities/GA_FatherAttack"
    FString AssetName;          // "GA_FatherAttack"
    FString GeneratorId;        // "GameplayAbility"
    FString ExecutedStatus;     // "New", "Skipped", "Failed", "Deferred"
    FString PlannedStatus;      // Dry-run: "WillCreate", "WillModify", "WillSkip", "Conflicted"
    bool bHasPlannedStatus;     // True for dry-run reports
    bool bAssetExistedBeforeRun;
    FString Reason;             // Success/failure message
    TArray<FGenerationError> Errors;
    TArray<FString> Warnings;
};
```

### FGenerationError

Structured error for programmatic handling:

```cpp
struct FGenerationError
{
    FString ErrorCode;      // "E_PARENT_CLASS_NOT_FOUND"
    FString ContextPath;    // "Abilities/GA_FatherAttack/parent_class"
    FString Message;        // Human-readable description
    FString SuggestedFix;   // Actionable fix suggestion
};
```

### UGenerationReport

Full report as UDataAsset:

```cpp
class UGenerationReport : public UDataAsset
{
    FGuid RunId;
    FDateTime Timestamp;
    FString GeneratorVersion;  // "4.7.0"
    FString ManifestFilePath;
    int64 ManifestHash;
    bool bIsDryRun;
    bool bIsForceRun;
    TArray<FGenerationReportItem> Items;

    // Summary counts
    int32 CountNew, CountSkipped, CountFailed, CountDeferred;
    int32 CountWillCreate, CountWillModify, CountWillSkip, CountConflicted;
};
```

## Output Locations

| Type | Path |
|------|------|
| UDataAsset | `/Game/Generated/Reports/GR_YYYYMMDD_HHMMSS_GUID8` |
| JSON | `Saved/GasAbilityGenerator/Reports/GR_YYYYMMDD_HHMMSS_GUID8.json` |
| Dry-run | Prefix: `GR_DryRun_...` |

## Generator IDs

Each generator populates `GeneratorId` before returning:

| GeneratorId | Asset Type |
|-------------|------------|
| Enumeration | E_ enumerations |
| InputAction | IA_ input actions |
| InputMappingContext | IMC_ input mappings |
| GameplayEffect | GE_ gameplay effects |
| GameplayAbility | GA_ gameplay abilities |
| ActorBlueprint | BP_ actor blueprints |
| WidgetBlueprint | WBP_ widget blueprints |
| Blackboard | BB_ blackboards |
| BehaviorTree | BT_ behavior trees |
| Material | M_ materials |
| MaterialFunction | MF_ material functions |
| FloatCurve | FC_ float curves |
| AnimationMontage | AM_ animation montages |
| AnimationNotify | NAS_ animation notifies |
| DialogueBlueprint | DBP_ dialogue blueprints |
| EquippableItem | EI_ equippable items |
| Activity | BPA_ activities |
| AbilityConfiguration | AC_ ability configs |
| ActivityConfiguration | ActConfig_ activity configs |
| ItemCollection | IC_ item collections |
| NarrativeEvent | NE_ narrative events |
| GameplayCue | GC_ gameplay cues |
| NPCDefinition | NPC_ NPC definitions |
| CharacterDefinition | CD_ character definitions |
| CharacterAppearance | Appearance_ appearances |
| TriggerSet | TS_ trigger sets |
| TaggedDialogueSet | TDS_ tagged dialogue |
| NiagaraSystem | NS_ niagara systems |
| ActivitySchedule | Schedule_ schedules |
| GoalItem | Goal_ goals |
| Quest | Quest_ quests |
| POIPlacement | Level actor POI |
| NPCSpawnerPlacement | Level actor spawner |

## JSON Report Example

```json
{
    "runId": "6069154F4974CAF380CA139A5941F34D",
    "timestamp": "2026-01-17T14:03:32.615Z",
    "generatorVersion": "4.7.0",
    "manifestFilePath": "C:/Unreal Projects/NP22B57/.../manifest.yaml",
    "manifestHash": 2971715670,
    "isDryRun": false,
    "isForceRun": false,
    "countNew": 155,
    "countSkipped": 0,
    "countFailed": 0,
    "countDeferred": 0,
    "items": [
        {
            "assetPath": "/Game/FatherCompanion/Enums/E_FatherForm",
            "assetName": "E_FatherForm",
            "generatorId": "Enumeration",
            "executedStatus": "New",
            "reason": "Created successfully",
            "errors": [],
            "warnings": []
        }
    ]
}
```

## Usage

Reports are automatically generated at the end of commandlet runs:

```bash
# Real run - generates GR_*.json
UnrealEditor-Cmd.exe ... -run=GasAbilityGenerator -manifest="..."

# Dry run - generates GR_DryRun_*.json
UnrealEditor-Cmd.exe ... -run=GasAbilityGenerator -manifest="..." -dryrun
```

## Implementation Pattern

Each generator populates AssetPath and GeneratorId before returning:

```cpp
FGenerationResult Result;
// ... generation logic ...

Result = FGenerationResult(Definition.Name, EGenerationStatus::New, TEXT("Created successfully"));
Result.AssetPath = AssetPath;  // Full content browser path
Result.GeneratorId = TEXT("GameplayAbility");
Result.DetermineCategory();
return Result;
```

For level actors (no content browser path):

```cpp
Result.AssetPath = FString::Printf(TEXT("LevelActor/POI/%s"), *Definition.POITag);
Result.GeneratorId = TEXT("POIPlacement");
```

## CI/CD Integration

Parse the JSON report to:
1. Verify expected assets were generated (`countNew`)
2. Detect failures (`countFailed`, `items[].errors`)
3. Identify conflicts requiring manual resolution (`countConflicted`)
4. Track manifest changes via `manifestHash`
5. Correlate runs via `runId`
